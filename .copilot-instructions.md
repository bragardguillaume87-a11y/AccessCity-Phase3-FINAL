# Instructions GitHub Copilot - AccessCity Phase 5.5

## WORKFLOW OBLIGATOIRE (A SUIVRE SYSTEMATIQUEMENT)

### Etape 1 - Architecte
1. Lire `docs/PROJECT_MEMORY_SEED.md`
2. Verifier checklist Phase 5.5
3. Verifier coherence avec Vision strategique

### Etape 2 - Ouvrier
1. Modifier `data/schemas.json` si nouvelle structure de donnees
2. Modifier `data/ui_layout.json` si nouveau panel ou layout
3. Modifier le code JavaScript (core/ui/services)
4. Creer tests unitaires correspondants

### Etape 3 - Controleur
1. Lancer `npm test` (doit passer 100%)
2. Verifier ASCII-only avec test/ascii-check.js
3. Valider selon criteres Phase 5.5

## REGLES ABSOLUES

### Encodage
- **INTERDIT** : Accents (é, è, à, ç), guillemets courbes (" "), caracteres > code 127
- **AUTORISE** : ASCII 32-126 uniquement (a-z, A-Z, 0-9, ponctuation basique)
- **Validation** : `npm test` inclut verification ASCII automatique

### Code
- **JAMAIS** : Fragments type `// ... existing code ...` ou `/* code existant */`
- **TOUJOURS** : Fichiers complets et fonctionnels
- **JAMAIS** : Optimisations non demandees
- **TOUJOURS** : Implementer exactement ce qui est requis

### Documentation
- **Limite** : 10 lignes max par explication (sinon synthetiser)
- **Priorite** : Code auto-documente > commentaires
- **INTERDIT** : Creer nouvelle doc si schema JSON suffit

## CHECKLIST PHASE 5.5 (EN COURS)

### Modules Core (Priorite P0)
- [x] VariableManager - Gestion variables narratives (Empathie, Autonomie, Confiance)
- [x] ConditionEvaluator - Evaluation conditions pour branching
- [x] CharacterLoader - Chargement et validation characters.json
- [ ] DialogueEngine - Execution scenarios narratifs (Phase 6.0)

### Data Files
- [x] `data/scenes.json` - Scenes narratives validees
- [ ] `data/characters.json` - Personnages (player, counsellor, narrator) **A CREER**
- [x] `data/schemas.json` - Schemas validation enrichis
- [x] `data/ui_layout.json` - **COMPLET** : 5 layouts (standard, focus, accessibility, devtools, narrative)

### UI Components (Vanilla)
- [x] SceneList.js - Liste scenes avec selection
- [x] InspectorPanel.js - Editeur CRUD scenes/dialogues
- [x] DevToolsPanel.js - Affichage variables temps reel
- [x] CharacterEditor.js - Edition personnages avec upload sprites

### UI Components (React - Branche Access-City-5.5a)
- [x] index-react.html - Standalone React + Tailwind
- [x] EditorMode - 3-column grid avec layout tabs
- [x] PlayerMode - Stage avec dialogues et choix
- [x] CharacterEditor modal - Upload sprites, mood selector, preview

### Tests Unitaires
- [x] `test/core.variableManager.test.js` (15 tests)
- [x] `test/core.conditionEvaluator.test.js` (15 tests)
- [x] `test/core.characterLoader.test.js` (8 tests async)
- [x] `test/test-integration-v5.js` (6/6 passing)

### Criteres Validation Phase 5.5 (Vanilla)
- [x] Variables narratives fonctionnelles (Empathie, Autonomie, Inclusion, Stress)
- [x] Personnages definis avec sprites et moods
- [x] Conditions evaluees pour filtrer dialogues
- [x] DevToolsPanel affiche variables temps reel
- [x] InspectorPanel dropdown personnages fonctionnel
- [x] 5 layouts UI disponibles et switchables

### Criteres Validation Phase 5.5a (React Alternative)
- [x] Layout tabs fonctionnels (standard/focus/accessibility/devtools)
- [x] CharacterEditor modal avec upload sprites
- [x] PlayerMode dialogue interactif avec variables
- [ ] Ameliorations UX pour 10 ans (onboarding, langage simplifie)
- [ ] Tous tests passent (`npm test`)

## ARCHITECTURE DATA-DRIVEN

### Principe
L'UI est entierement pilotee par JSON, pas de logique hardcodee.

### Fichiers Pilotes
- `ui_layout.json` → Structure panels (position, taille, visibilite)
- `scenes.json` → Contenu narratif
- `characters.json` → Personnages et sprites
- `schemas.json` → Validation structure donnees

### Modification Type
1. Ajouter structure dans `schemas.json`
2. Creer/modifier fichier data correspondant
3. Creer loader dans `core/` si necessaire
4. Creer composant UI dans `ui/` pour affichage
5. Tester avec `npm test`

## PRIORITES ACTUELLES (Branche Access-City-5.5a)

### Version React Alternative
- Interface moderne React + Tailwind CSS
- Standalone HTML (pas de build)
- Core vanilla preserve (EventBus, DialogueEngine, VariableManager)
- UX adaptee enfants 10 ans

### Ameliorations UX Necessaires
1. **Onboarding interactif** - Popup bienvenue, tooltips
2. **Langage adapte** - "Editeur" → "Creer mon histoire", "Variables" → "Sentiments"
3. **Feedback visuel** - Animations, sons, messages encourageants
4. **Mode Decouverte vs Creation** - Bouton "Jouer" vs "Creer"
5. **Gamification** - Badges, progression visible

### Accessibilite (PRIORITE ABSOLUE)
- Navigation clavier complete (Tab, Shift+Tab, Echap)
- Trackball/eViacam compatible
- Lecteur ecran compatible (ARIA labels)
- Contraste eleve (WCAG AA minimum)
- Focus visible (outline 2px)

## PHASES FUTURES

### Phase 6.0 (Moteur Runtime) - Q1 2026
- DialogueEngine execution autonome
- TimelineService
- NodePreview

### Phase 6.5 (Assets & Audio) - Q2 2026
- AssetLoader
- AudioService
- SpriteManager

### Phase 7.0 (Export GDevelop) - Q3 2026
- GDevelopExporter
- EventMapper

## ERREURS A EVITER

### Erreurs Passees
- Documentation trop lourde → Hallucinations IA
- Tests verbeux non executables → Convertis tests stricts
- Versions hardcodees multiples → Centralisees constants.js
- Code fragments partiels → Fichiers complets uniquement

### Corrections Appliquees
- Doc <10k tokens par fichier
- Tests unitaires executables
- VERSION centralisee (5.0.0 dans core/constants.js)
- Interdiction fragments code

## COMMANDES UTILES

```bash
# Validation complete
npm test

# Serveur dev
npm run dev

# Verification ASCII
node test/ascii-check.js

# Tests integration
node test/test-integration-v5.js
```

## REFERENCES DOCUMENTATION

- `docs/PROJECT_MEMORY_SEED.md` - Vision strategique et checklist Phase 5.5
- `docs/AI_CONTEXT.md` - Contexte detaille pour IA
- `docs/ROADMAP.md` - Plan phases futures
- `docs/UI_DESIGN_SYSTEM.md` - Tokens design et composants
- `docs/AccessCity_Agentic_Workflow.md` - Workflow IA optimise

---

**RAPPEL** : Avant toute modification, verifier cette checklist et `docs/PROJECT_MEMORY_SEED.md`
